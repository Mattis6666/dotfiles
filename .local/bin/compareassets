#!/bin/bash

RED="\033[31m"
YELLOW="\033[1;33m"
CYAN="\033[36m"
RESET="\033[0m"

DELETE_LINE="\r\033[0K"

die() {
	[ -z "$1" ] || echo -e "$*"
	exit 0
}

[ -z "$2" ] && die "Usage:\n\t$0 <command> <file glob>\n\nExample:\n\t$0 sxiv **/sectionpass.*"

command=$1
shift

type $command > /dev/null 2>&1 || die "$command is not a valid command."

cancel() {
	if [ -z $counter ]; then
		counter=1
		sleep .2 && unset counter
	else
		die
	fi
}

trap cancel SIGINT

echo -e "${CYAN}/----------------------------\\"
echo -e "${CYAN}| Press CTRL+C twice to exit |"
echo -e "${CYAN}\\----------------------------/"

for file; do
	echo -ne "${CYAN}Now viewing ${YELLOW}$file${RESET}"
	$command "$file" > /dev/null 2>&1
	echo -ne $DELETE_LINE
done
